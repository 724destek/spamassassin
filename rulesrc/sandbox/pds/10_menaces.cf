header   __PDS_FROM_NAME_TO_DOMAIN  ALL =~ /From: ["']?([a-z0-9\.-]+\.[0-9a-z\.-]+)["']? [^\n]+\nTo:[^\n]+\@\1/ism

meta     PDS_FROM_NAME_TO_DOMAIN __PDS_FROM_NAME_TO_DOMAIN
score    PDS_FROM_NAME_TO_DOMAIN 1.0
describe PDS_FROM_NAME_TO_DOMAIN From:name looks like To:domain

rawbody    __PDS_HIDDEN_UK_BUSINESSLOAN /style="[^"]*display:none[^"]*">.*UK's [a-z]+ rates for business loans/

meta     PDS_HIDDEN_UK_BUSINESSLOAN __PDS_HIDDEN_UK_BUSINESSLOAN
describe PDS_HIDDEN_UK_BUSINESSLOAN UK's <word> rates for business loans
score    PDS_HIDDEN_UK_BUSINESSLOAN 2.0 # limit
reuse    PDS_HIDDEN_UK_BUSINESSLOAN

uri  __PDS_DOUBLE_URL m;https?://[\S]+(?:\?|=)https?://[\S]+[\w]+$;

meta     PDS_DOUBLE_URL __PDS_DOUBLE_URL
describe PDS_DOUBLE_URL URL that ends with a URL
score    PDS_DOUBLE_URL 1.0 # limit
reuse    PDS_DOUBLE_URL

meta     PDS_DBL_URL_LINKBAIT __BODY_URI_ONLY && __PDS_DOUBLE_URL
describe PDS_DBL_URL_LINKBAIT Linkbait double-url
score    PDS_DBL_URL_LINKBAIT 2.5 # limit
reuse    PDS_DBL_URL_LINKBAIT

meta     PDS_DBL_URL_TNB_RUNON __TO_NO_BRKTS_FROM_RUNON && __PDS_DOUBLE_URL
describe PDS_DBL_URL_TNB_RUNON Double-url and To no arrows, from runon
score    PDS_DBL_URL_TNB_RUNON 2.0
reuse    PDS_DBL_URL_TNB_RUNON

meta     PDS_DBL_URL_ILLEGAL_CHARS SUBJ_ILLEGAL_CHARS && __PDS_DOUBLE_URL
describe PDS_DBL_URL_ILLEGAL_CHARS Double url illegal subject characters
score    PDS_DBL_URL_ILLEGAL_CHARS 2.0
reuse    PDS_DBL_URL_ILLEGAL_CHARS

meta     FROM_2_EMAILS_SHORT __KAM_BODY_LENGTH_LT_512 && __PDS_FROM_2_EMAILS
describe FROM_2_EMAILS_SHORT Short body and From looks like 2 different emails
score    FROM_2_EMAILS_SHORT 2.0 # limit
reuse    FROM_2_EMAILS_SHORT

body     __PDS_BODY_QUOTE / [\w\s,\.]+ - ([A-Z][a-z'\.]+ ?){1,4}/
header   __PDS_SUBJECT_QUOTE Subject =~ /\bquotes?\b/i

meta     SHORT_BODY_QUOTE  __PDS_SUBJECT_QUOTE && __PDS_BODY_QUOTE && __KAM_BODY_LENGTH_LT_256
describe SHORT_BODY_QUOTE Short body with quote - used for warming up domains
score    SHORT_BODY_QUOTE 2.0
reuse    SHORT_BODY_QUOTE

meta     BODY_QUOTE_MALF_MSGID __MSGID_NOFQDN2 && __PDS_BODY_QUOTE
describe BODY_QUOTE_MALF_MSGID Malformed MSGID with quote
score    BODY_QUOTE_MALF_MSGID 2.0
reuse    BODY_QUOTE_MALF_MSGID

meta     SPOOFED_FREEMAIL_NO_RDNS __SPOOFED_FREEMAIL && __RDNS_NONE
describe SPOOFED_FREEMAIL_NO_RDNS From SPOOFED_FREEMAIL and no rDNS
score    SPOOFED_FREEMAIL_NO_RDNS 1.5
reuse    SPOOFED_FREEMAIL_NO_RDNS

uri	 __KHOP_URI_HIDDEN	m'.{7}\/\.\.?/?\w'

meta     PDS_URI_HIDDEN_HELO_NO_DOMAIN __HELO_NO_DOMAIN && __KHOP_URI_HIDDEN
describe PDS_URI_HIDDEN_HELO_NO_DOMAIN Hidden URI, HELO not domain
score    PDS_URI_HIDDEN_HELO_NO_DOMAIN 2.0
reuse    PDS_URI_HIDDEN_HELO_NO_DOMAIN

header   __PDS_TONAME_EQ_TOLOCAL To:raw =~ /^\s*['"]?([^'"]+)['"]? <?\1\@/

meta     PDS_TONAME_EQ_TOLOCAL_HDRS_LCASE __PDS_TONAME_EQ_TOLOCAL && __HDRS_LCASE
describe PDS_TONAME_EQ_TOLOCAL_HDRS_LCASE To: name matches everything in local email - LCASE headers
score    PDS_TONAME_EQ_TOLOCAL_HDRS_LCASE 2.0 # limit
reuse    PDS_TONAME_EQ_TOLOCAL_HDRS_LCASE

meta     PDS_TONAME_EQ_TOLOCAL_SHORT __PDS_TONAME_EQ_TOLOCAL && __KAM_BODY_LENGTH_LT_512
describe PDS_TONAME_EQ_TOLOCAL_SHORT Short body with To: name matches everything in local email
score    PDS_TONAME_EQ_TOLOCAL_SHORT 2.0 # limit
reuse    PDS_TONAME_EQ_TOLOCAL_SHORT

meta     PDS_TONAME_EQ_TOLOCAL_FREEM_FORGE FREEMAIL_FORGED_REPLYTO && __PDS_TONAME_EQ_TOLOCAL
describe PDS_TONAME_EQ_TOLOCAL_FREEM_FORGE Forged replyto and __PDS_TONAME_EQ_TOLOCAL
score    PDS_TONAME_EQ_TOLOCAL_FREEM_FORGE 2.0 # limit
reuse    PDS_TONAME_EQ_TOLOCAL_FREEM_FORGE

meta     PDS_TONAME_EQ_TOLOCAL_VSHORT __KAM_BODY_LENGTH_LT_128 && __PDS_TONAME_EQ_TOLOCAL
describe PDS_TONAME_EQ_TOLOCAL_VSHORT Very short body and From looks like 2 different emails
score    PDS_TONAME_EQ_TOLOCAL_VSHORT 1.0 # limit
reuse    PDS_TONAME_EQ_TOLOCAL_VSHORT

